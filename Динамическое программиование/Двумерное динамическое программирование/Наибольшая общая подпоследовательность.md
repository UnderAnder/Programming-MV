## Наибольшая общая подпоследовательность
A, B - одномерные массивы чисел len(A) == N, len(B) == M
Подпоследовательность - список C, содержащий элементы A в исходном порядке, но, возможно, не все
[ ] - подпоследовательность любой последовательности A
$F_{ij}$ - длина наибольшей возможой подпоследовательностьчастей A и B: 
$A_i$ = A[0:i] часть A, первые i элементов
$B_j$ = B[0:j] часть A, первые j элементов
$[a_1, a_2, a_3, ... a_{i-1}, a_i]$
$$F_{ij}= \begin{cases}
1 + F_{(i-1)(j-1)}, a_i = b_j \\ 
max(F_{i(j-1)},F_{(i-1)j}), a_i \neq b_j
\end{cases}$$
$F_{0j}=0$
$F_{i0}=0$
![[a_i = b_j.png]]
```py
def lcs(A,B): # Longest Common Subsequence
    F = [[0]*(len(B)+1) for i in range(len(A)+1)] # резервация памяти
    for i in range(1, len(A)+1):
        for j in range(1, len(B)+1):
            if A[i-1] == B[j-1]:
                F[i][j] = 1 + F[i-1][j-1]
            else:
                F[i][j] = max(F[i-1][j], F[i][j-1])
    return F[-1][-1] # последний элемент
```
$O(M*N)$